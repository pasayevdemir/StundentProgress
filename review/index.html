<!DOCTYPE html>
<html lang="az">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>T…ôl…ôb…ô Qiym…ôtl…ôndirm…ôsi - PeerStack</title>
    <link rel="stylesheet" href="../css/sidebar.css">
    <link rel="stylesheet" href="../css/preload.css">
    <link rel="stylesheet" href="index.css">
</head>
<body>
    <script>
        (function() {
            document.body.classList.add('preload');
            const isDarkMode = localStorage.getItem('darkMode') === 'true';
            if (isDarkMode) {
                document.body.classList.add('dark-theme');
            }
            const sidebarOpen = localStorage.getItem('sidebarOpen') !== 'false';
            if (!sidebarOpen) {
                document.body.classList.add('sidebar-collapsed');
            }
        })();
    </script>
    <div class="page-wrapper">
        <div class="container">
            <div class="header">
                <h1>T…ôl…ôb…ô Qiym…ôtl…ôndirm…ô</h1>
                <div class="header-actions">
                    <button class="upload-btn" onclick="document.getElementById('csvFileInput').click()">
                        üì§ CSV Y√ºkl…ô
                    </button>
                    <input type="file" id="csvFileInput" accept=".csv,.txt" style="display: none;">
                </div>
            </div>

            <!-- Axtarƒ±≈ü B√∂lm…ôsi -->
            <div class="search-section">
                <div class="search-box">
                    <input type="text" id="searchInput" placeholder="üîç T…ôl…ôb…ô adƒ±nƒ± axtarƒ±n..." autocomplete="off">
                    <div id="searchResults" class="search-results"></div>
                </div>
            </div>

            <!-- T…ôl…ôb…ôl…ôr C…ôdv…ôli -->
            <div class="students-table-container">
                <div class="table-header">
                    <h2 id="tableTitle">Qiym…ôtl…ôndirilm…ômi≈ü T…ôl…ôb…ôl…ôr</h2>
                    <button id="toggleViewBtn" class="toggle-btn" onclick="reviewController.toggleView()">
                        B√ºt√ºn T…ôl…ôb…ôl…ôr
                    </button>
                </div>
                <div class="table-scroll-wrapper">
                    <table id="studentsTable" class="students-table">
                        <thead>
                            <tr>
                                <th>Adƒ± Soyadƒ±</th>
                                <th>Email</th>
                                <th>Cohort</th>
                                <th>Status</th>
                                <th>Modullar</th>
                                <th>∆èm…ôliyyat</th>
                            </tr>
                        </thead>
                        <tbody id="studentsTableBody">
                            <tr><td colspan="6" style="text-align: center;">T…ôl…ôb…ôl…ôr y√ºkl…ônir...</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <!-- Notification Popup -->
    <div id="notificationPopup" class="notification-popup hidden">
        <div class="notification-content">
            <div class="notification-icon">‚úì</div>
            <p id="notificationMessage"></p>
        </div>
    </div>

    <!-- Global Loader -->
    <div id="globalLoader" class="global-loader" style="display: none;">
        <div class="loader-spinner"></div>
        <p>Y√ºkl…ônir...</p>
    </div>

    <script src="https://unpkg.com/@supabase/supabase-js@2"></script>
    <script src="../js/config.js"></script>
    <script src="../js/utils/UIHelper.js"></script>
    <script src="../js/utils/CSVParser.js"></script>
    <script src="../js/models/StudentModel.js"></script>
    <script src="../js/models/ProgressModel.js"></script>
    <script src="../js/models/ReviewModel.js"></script>
    <script src="../js/models/ReviewerModel.js"></script>
    <script src="../js/controllers/ReviewController.js"></script>
    <script src="../js/controllers/CSVUploadController.js"></script>
    <script src="../js/components/Sidebar.js"></script>
    <script>
        // Initialize controllers
        const reviewController = new ReviewController();
        const csvUploadController = new CSVUploadController();
        
        // Initialize on page load
        document.addEventListener('DOMContentLoaded', () => {
            reviewController.init();
            
            // CSV file input handler
            document.getElementById('csvFileInput').addEventListener('change', (e) => {
                const file = e.target.files[0];
                if (file) {
                    csvUploadController.handleFileUpload(file);
                    e.target.value = ''; // Reset input
                }
            });
        });
    </script>
</body>
</html>
